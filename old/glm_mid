#! /bin/csh


#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-
#                                                                        
#    3dDeconvolve Regression
#
#    Auto-generated by ScriptWriter.py
#    kiefer katovich 2012
#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-


set MAINDIR = ${HOME}/cueexp

set SCRIPTSDIR = ${MAINDIR}/scripts
set DATADIR = ${MAINDIR}/data
set OUTDIR = ${DATADIR}/results_mid

if (! -d ${OUTDIR}) then
	mkdir ${OUTDIR}
endif

#-#-#-#-#-#-#-#-#-#-#-		Cycle through subjects:		-#-#-#-#-#-#-#-#-#-#-#



foreach subject ( zl150930 ps151001 dw151003 ie151020 aa151010 al151016 ag151024 sr151031 vm151031 si151120 jg151121 tf151127 wr151127 ja151218 tm160117 kl160122 as160129 wh160130 ss160205 rp160205 bp160213 cs160214 nb160221 rf160313 jw160316 as160317 pk160319 jc160320 jc160321 bb160402 jn160403 rb160407 )

#foreach subject ( nd150921 )


    cd ${DATADIR}/${subject}/func_proc
    echo processing ${subject} 



#-#-#-#-#-#-#-#-#-#-#-		Run 3dDeconvolve:		-#-#-#-#-#-#-#-#-#-#-#

	3dDeconvolve -float -jobs 4 -input pp_mid_tlrc.nii -concat ${SCRIPTSDIR}/mid_runs_wEnd.1D -nfirst 0 -num_stimts 14 -polort 2 -dmbase -censor mid_censor.1D \
		-stim_file 1 'vr.1D[1]' -stim_label 1 'roll' \
		-stim_file 2 'vr.1D[2]' -stim_label 2 'pitch' \
		-stim_file 3 'vr.1D[3]' -stim_label 3 'yaw' \
		-stim_file 4 'vr.1D[4]' -stim_label 4 'dS' \
		-stim_file 5 'vr.1D[5]' -stim_label 5 'dL' \
		-stim_file 6 'vr.1D[6]' -stim_label 6 'dP' \
		-stim_file 7 'csf.1D' -stim_label 7 'csf' \
		-stim_file 8 'wm.1D' -stim_label 8 'wm' \
		-stim_file 9 '../regs/ant_midc.1D' -stim_label 9 'ant' \
		-stim_file 10 '../regs/out_midc.1D' -stim_label 10 'out' \
		-stim_file 11 '../regs/gvn_ant_midc.1D' -stim_label 11 'gvnant' \
		-stim_file 12 '../regs/lvn_ant_midc.1D' -stim_label 12 'lvnant' \
		-stim_file 13 '../regs/gvn_out_midc.1D' -stim_label 13 'gvnout' \
		-stim_file 14 '../regs/nvl_out_midc.1D' -stim_label 14 'nvlout' \
		-tout -fout -bucket ${subject}_glm
	

	3drefit -space tlrc -view tlrc ${subject}_glm+orig
	
#-#-#-#-#-#-#-#-#-#-#-		Write zscored dataset:		-#-#-#-#-#-#-#-#-#-#-#

	
	3dmerge -doall -1zscore -prefix ${subject}_zmid ${subject}_glm+tlrc
	
	
#-#-#-#-#-#-#-#-#-#-#-		Remove non-zscored dataset:		-#-#-#-#-#-#-#-#-#-#-#

	#rm -rf mid_glm+tlrc*
	
#-#-#-#-#-#-#-#-#-#-#-		move results to results dir		-#-#-#-#-#-#-#-#-#-#-#
	

	mv *glm* ${OUTDIR}
	
end



